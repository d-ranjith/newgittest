import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.HashMap;
import java.util.Map;
import java.util.Properties;

public class Main {

    public static void main(String[] args) {
        String secretPath = "/etc/secrets/secret";
        Map<String, String> secrets = readSecretsFromFile(secretPath);

        // Set secrets as environment variables
        for (Map.Entry<String, String> entry : secrets.entrySet()) {
            System.setProperty(entry.getKey(), entry.getValue());
        }

        // Your Java application logic here...
    }

    private static Map<String, String> readSecretsFromFile(String filePath) {
        Map<String, String> secrets = new HashMap<>();

        try {
            Properties properties = new Properties();
            properties.load(Files.newInputStream(Paths.get(filePath)));

            for (String key : properties.stringPropertyNames()) {
                secrets.put(key, properties.getProperty(key));
            }
        } catch (IOException e) {
            throw new RuntimeException("Error reading secrets from file: " + filePath, e);
        }

        return secrets;
    }
}
