import os

def generate_directory_tree_html(path, base_path="/"):
    """
    Recursively generates HTML for directory structure.
    """
    html = "<ul>"
    for item in sorted(os.listdir(path)):
        item_path = os.path.join(path, item)
        web_path = os.path.join(base_path, item)
        if os.path.isdir(item_path):
            html += f'<li><span class="folder">{item}</span>'
            html += generate_directory_tree_html(item_path, web_path + "/")
            html += '</li>'
        else:
            html += f'<li><a href="#" onclick="loadFile(\'{web_path}\')">{item}</a></li>'
    html += "</ul>"
    return html

def create_index_html(output_dir):
    """
    Create an index.html file in the output directory.
    """
    base_directory_name = os.path.basename(output_dir)
    html_content = f"""
    <html>
    <head>
        <title>Cluster Output Files - {base_directory_name}</title>
        <style>
            body {{ font-family: Arial, sans-serif; display: flex; height: 100vh; overflow: hidden; }}
            #directoryTree {{ width: 300px; overflow-y: auto; border-right: 1px solid #ccc; padding: 10px; }}
            #contentPane {{ flex-grow: 1; overflow-y: auto; padding: 10px; }}
            .folder {{ font-weight: bold; }}
            ul {{ list-style-type: none; padding-left: 0; }}
            li {{ margin: 5px 0; }}
            a {{ text-decoration: none; color: blue; }}
            a:hover {{ text-decoration: underline; }}
        </style>
        <script>
            function loadFile(url) {{
                fetch(url)
                    .then(response => response.text())
                    .then(text => document.getElementById('contentPane').innerText = text)
                    .catch(err => console.error(err));
            }}
        </script>
    </head>
    <body>
        <div id="directoryTree">
            <h2>Directory: {base_directory_name}</h2>
            {generate_directory_tree_html(output_dir)}
        </div>
        <div id="contentPane">
            <h3>Content Viewer</h3>
            Click on a file to view its contents here.
        </div>
    </body>
    </html>
    """
    with open(os.path.join(output_dir, "index.html"), "w") as f:
        f.write(html_content)

# Example usage, ensure to specify the correct output directory path
output_dir = "/path/to/your/cluster_metrics_directory"
create_index_html(output_dir)
