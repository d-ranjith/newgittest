import requests
import time
import urllib3
import logging

# Disable urllib3 warnings
urllib3.disable_warnings()

# Configure logging
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

pipelineType = 'ls-pipeline-factory'

values_file = "values.txt"
url = 'https://myapp/v2beta1/projects/<projectname>/pipelines'
headers = {'Content-Type': 'application/json', 'Accept': 'application/json', 'Authorization': "Basic XXXXX"}
certificate_path = 'C:/users/<myname>/dot.pem'

with open(values_file, "r") as file:
    for line in file:
        value = line.strip()
        data = {"spec": {"pipelineName": value, "pipelineType": pipelineType}}
        logging.info(f"Current project: {value}")
        try:
            response = requests.patch(url, json=data, headers=headers, verify=certificate_path)
            response.raise_for_status()  # Raise error for non-2xx status codes
            logging.info(response.json())
        except requests.exceptions.RequestException as e:
            logging.error(f"Error occurred: {e}")
        time.sleep(1)
