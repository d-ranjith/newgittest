import os
import logging

class MyApp:
    def __init__(self, file_downloader, api_uploader, logger):
        self.file_downloader = file_downloader
        self.api_uploader = api_uploader
        self.logger = logger

    def download_and_extract_artifact(self, artifact_url, output_dir):
        self.logger.info("Downloading and extracting artifact...")
        downloaded_file_path = self.file_downloader.download_file(artifact_url)
        if downloaded_file_path:
            extracted_file_path = self.file_downloader.extract_file(downloaded_file_path)
            if extracted_file_path:
                self.logger.info("Artifact downloaded and extracted successfully.")
                return extracted_file_path
            else:
                self.logger.error("Failed to extract the artifact.")
        else:
            self.logger.error("Failed to download the artifact.")
        return None

    def upload_artifact(self, artifact_path):
        self.logger.info("Uploading artifact...")
        upload_success = self.api_uploader.upload_file(artifact_path)
        if upload_success:
            self.logger.info("Artifact uploaded to the API endpoint successfully.")
        else:
            self.logger.error("Failed to upload the artifact to the API endpoint.")

    def process_artifact(self, artifact_url, output_dir):
        extracted_file_path = self.download_and_extract_artifact(artifact_url, output_dir)
        if extracted_file_path:
            # Proceed with further processing or actions
            self.logger.info("Artifact processed successfully.")
            self.upload_artifact(extracted_file_path)



...
# Configure logging
logging.basicConfig(level=logging.INFO, format="[%(levelname)s] %(asctime)s %(message)s", datefmt="%Y-%m-%d %H:%M:%S")

# Create a logger
logger = logging.getLogger(__name__)

...

if __name__ == "__main__":
    load_environment_variables()

    file_downloader = TgzFileDownloader()
    api_uploader = CertAPIUploader()
    app = MyApp(file_downloader, api_uploader, logger)
    app.process_artifact('https://example.com/file.tgz')
